//===========================================================================//
// Include                                                                   //
//===========================================================================//
#include "Resource.h"
#include "ResourceManager.h"


//===========================================================================//
// Constructeur par défaut                                                   //
//===========================================================================//
Resource::Resource(): m_RefCount(0)
{

}

//===========================================================================//
// Destructeur Resource	                                                     //
//===========================================================================//
Resource::~Resource()
{
	ResourceManager::GetInstance()->Remove(m_Crc32);
}


//===========================================================================//
// Renvoie le nom associé à la resource                                      //
//===========================================================================//
const crc32& Resource::GetCRC32() const
{
    return m_Crc32;
}

//===========================================================================//
// Ajoute une référence à la resource                                        //
//===========================================================================//
void Resource::AddRef()
{
    ++m_RefCount;
}


//===========================================================================//
// Retire une référence sur la resource                                      //
//===========================================================================//
int Resource::Release()
{
    // Décrémentation du compteur de références
    int RefCount = --m_RefCount;

    // S'il n'y a plus de référence sur la ressource, on la détruit
    if (RefCount == 0)
        delete this;

    return RefCount;
}
